"use strict";Array.prototype.find||(Array.prototype.find=function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),l=n.length>>>0,o=arguments[1],a=0;a<l;a++)if(e=n[a],t.call(o,e,a,n))return e}),Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),l=n.length>>>0,o=arguments[1],a=0;a<l;a++)if(e=n[a],t.call(o,e,a,n))return a;return-1});var tbHelper={emptyPages:["blank","empty","no_text"],panelSeparators:[{label:"Long dash",value:"–"},{label:"Single dash",value:"-"},{label:"Double dash",value:"--"},{label:"Equal sign",value:"="}],styleProps:{keyword:{label:"Keyword",def:null},layerGroup:{label:"Layer Group",def:null},fontName:{label:"Font Name",values:[],def:"ArialMT"},size:{label:"Size",def:25,min:1,max:1e3},leading:{label:"Leading",def:0,min:0,max:1e3},tracking:{label:"Tracking",def:0,min:-1e3,max:1e4},vScale:{label:"VScale",def:100,min:1,max:1e3},hScale:{label:"HScale",def:100,min:1,max:1e3},capitalization:{label:"Capitalization",values:[{value:"ALLCAPS",label:"All caps"},{value:"NORMAL",label:"Normal"},{value:"SMALLCAPS",label:"Small caps"}],def:"NORMAL"},justification:{label:"Justification",values:[{value:"CENTER",label:"Center"},{value:"CENTERJUSTIFIED",label:"Center justified"},{value:"FULLYJUSTIFIED",label:"Fully justified"},{value:"LEFT",label:"Left"},{value:"LEFTJUSTIFIED",label:"Left justified"},{value:"RIGHT",label:"Right"},{value:"RIGHTJUSTIFIED",label:"Right justified"}],def:"CENTER"},antialias:{label:"Antialias",values:[{value:"CRISP",label:"Crisp"},{value:"SHARP",label:"Sharp"},{value:"SMOOTH",label:"Smooth"},{value:"STRONG",label:"Strong"},{value:"NONE",label:"None"}],def:"SMOOTH"},fauxBold:{label:"FauxBold",def:!1},fauxItalic:{label:"FauxItalic",def:!1},hyphenate:{label:"Hyphenate",def:!0},kerning:{label:"Kerning",values:[{value:"METRICS",label:"Metrics"},{value:"OPTICAL",label:"Optical"}],def:"METRICS"}},getSylePropValues:function(t){for(var e=[],n=0;n<this.styleProps[t].values.length;n++)e.push(styleProps[t].values[n].value);return e},getDummyStyle:function(t,e){var n={};for(var l in tbHelper.styleProps)n[l]=tbHelper.styleProps[l].def;return t&&(n.keyword=t),e&&(n.default=!0),n},getDummyStyleSet:function(){var t={name:null,styles:[this.getDummyStyle("default_style",!0)]};return t},checkStyleSet:function(t){var e=0;if(!t.styles)throw"No styles in set";for(var n=0;n<t.styles.length;n++){if(!t.styles[n].keyword)throw"Some style keywords are undefined";if(t.styles[n].keyword=t.styles[n].keyword.trim().toLowerCase(),void 0!=t.styles[n].default&&1==t.styles[n].default&&(++e,"default_style"!=t.styles[n].keyword))throw'Default style must be named "default_style"'}if(0===e)throw"Missing default style";if(e>1)throw"Only one default style allowed";t.styles.sort(function(t,e){return t.keyword<e.keyword?-1:t.keyword>e.keyword?1:0});for(var n=0;n<t.styles.length;n++)t.styles[n]=this.cleanStyle(t.styles[n])},cleanStyle:function(t){for(var e in tbHelper.styleProps)void 0!=t[e]&&null!==t[e]||(t[e]=tbHelper.styleProps[e].def);return t},getStyleFromStyleSet:function(t,e){if(!t)throw"No style set";if(!t.styles)throw"No styles in set";var n=t.styles.find(function(t){return t.keyword==e.toLowerCase()});if(n)return this.cleanStyle(n);throw"Style not found"},getFilePageNumber:function(t){var e=/^.*[-_\ ]([\d]{3,4}-[\d]{3,4})\.psd$/,n=e.exec(t);return n&&n[1]?n[1]:(e=/^.*[-_\ ]([\d]{3,5})\.psd$/,n=e.exec(t),n&&n[1]?n[1]:null)},getPageNumbers:function(t){for(var e,n=[],l=/\b([\d-]{3,9})#/g;null!==(e=l.exec(t));)e.index===l.lastIndex&&l.lastIndex++,n.push(e[1]);return n},loadPage:function(t,e){var n=new RegExp("\\b"+e+"#\\ ?(.*)?\\n([\\s\\S]*?)($|END|[\\d-]{3,9}#)"),l=n.exec(t);return l?l:null},pageContainsText:function(t){if(!t)return!1;if(t=t.trim(),0===t.length)return!1;for(var e=0;e<this.emptyPages.length;e++)if(0==t.indexOf("["+this.emptyPages[e]+"]"))return!1;return!0},getTextStyles:function(t,e){if(!t)return e?[e]:null;var n=/\[(\[?\w+)\]/g,l=n.exec(t);if(l&&l[1]){n.lastIndex=0;for(var o=[];null!==(l=n.exec(t));)l.index===n.lastIndex&&n.lastIndex++,0!=l[1].indexOf("[")?o.push(l[1].toLowerCase()):o.length||o.push(e);return o}return e?[e]:null},getNotes:function(t){if(!t)return null;var e=/\[{2}([^\[]+)\]{2}/g,n=e.exec(t);if(n&&n[1]){e.lastIndex=0;for(var l=[];null!==(n=e.exec(t));)n.index===e.lastIndex&&e.lastIndex++,l.push(n[1]);return l}return null},cleanLine:function(t){if(!t)return null;var e=/(\/{0,2}\ ?)?(\[[\s\w\d]*\]\ ?)*([^\[]*)/,n=e.exec(t);return n&&n[n.length-1]?n[n.length-1].trim():null},skipThisLine:function(t,e){return!t||(t=this.cleanLine(t),!t||0==t.length||t.charCodeAt(0)==e.charCodeAt(0)&&null)},isMultiBubblePart:function(t){if(!t)return!1;t=t.trim();var e=/^\/{2}.*$/,n=e.test(t);return!!n}},tb=angular.module("tb",["templates","ngSanitize","ui.router","ui.bootstrap","ngStorage","ngToast","angular-clipboard"]);tb.constant("CONF",{appName:"typeset_buddy",debug:!1,version:"0.1.11"}),tb.config(["$localStorageProvider","ngToastProvider",function(t,e){t.setKeyPrefix("tb_"),e.configure({verticalPosition:"bottom",maxNumber:10})}]),tb.run(["CONF","$transitions","$state","$stateParams","$rootScope","$trace","themeManager","$localStorage",function(t,e,n,l,o,a,s,i){function r(t){var e;e=t?new CSEvent("com.adobe.PhotoshopPersistent","APPLICATION"):new CSEvent("com.adobe.PhotoshopUnPersistent","APPLICATION"),e.extensionId=o.extensionID,o.CSI.dispatchEvent(e)}o.$state=n,o.$stateParams=l,o.CSI=new CSInterface,o.extensionID=o.CSI.getExtensionID();for(var c=["polyfills","tb_helper"],p=o.CSI.getSystemPath(SystemPath.EXTENSION)+"/jsx/",u=0;u<c.length;u++){var d=p+c[u]+".jsx",g='$.evalFile("'+d+'");';o.CSI.evalScript(g,function(t){})}s.init(),o.os=o.CSI.getOSInformation().toLowerCase().indexOf("mac")>=0?"Mac":"Windows",o.debug=t.debug,o.log=function(t,e){1==o.debug&&(o.logContent||(o.logContent=[]),angular.isDefined(e)?(o.logContent.push({label:t,value:e}),console.log(t,e)):(o.logContent.push({label:"log",value:t}),console.log(t)))};var y=function(t,e){return i.lastOpenedTab=t.to().name,t};e.onFinish(!0,y,{priority:10}),1==o.debug?(a.enable(1),r(!1)):r(!0),o.$watch("debug",function(t,e){t!=e&&(o.debug?(a.enable(1),r(!1)):(a.disable(1),r(!0)))})}]),tb.config(["$stateProvider","$urlRouterProvider","$localStorageProvider",function(t,e,n){n.get("lastOpenedTab")?e.otherwise(n.get("lastOpenedTab")):e.otherwise("/styles"),t.state("app",{url:"/",controller:"AppCtrl",templateUrl:"app.tpl.html"}),t.state("log_view",{url:"/log_view",parent:"app",views:{app:{controller:["$scope",function(t){t.clearLog=function(){t.$root.logContent=[]}}],templateUrl:"log_view.tpl.html"}}})}]),tb.controller("AppCtrl",["$scope","$localStorage","$uibModal","Utils",function(t,e,n,l){t.resetLocalStorage=function(){l.showConfirmDialog("Are you sure you reset the localstorage? Every style set will be deleted.").then(function(){e.$reset()},function(){})},t.routes=[],t.$state.get().forEach(function(e){angular.isDefined(e.nav)&&e.nav===!0&&t.routes.push({name:e.name,label:e.label,order:e.order})}),t.routes.sort(function(t,e){return t.order<e.order?-1:t.order>e.order?1:0})}]),tb.factory("themeManager",["$rootScope","Utils",function(t,e){var n=this,l=void 0,o=void 0,a=void 0,s=void 0,i=document.getElementById("theme"),r=document.getElementById("tb");return n.updateThemeWithAppSkinInfo=function(t){l=t.panelBackgroundColor.color,o=e.colorToHex(l),a="F0F0F0",s=l.red>=122,s?(a="000000",i.href="css/topcoat-desktop-light.css",r.classList.remove("dark"),r.classList.add("light")):(i.href="css/topcoat-desktop-dark.css",r.classList.remove("light"),r.classList.add("dark")),r.style.backgroundColor="#"+o,r.style.color="#"+a},n.onAppThemeColorChanged=function(t){var e=JSON.parse(window.__adobe_cep__.getHostEnvironment()).appSkinInfo;n.updateThemeWithAppSkinInfo(e)},n.init=function(){n.updateThemeWithAppSkinInfo(t.CSI.hostEnvironment.appSkinInfo),t.CSI.addEventListener(CSInterface.THEME_COLOR_CHANGED_EVENT,n.onAppThemeColorChanged)},n}]),tb.factory("Utils",["$uibModal",function(t){var e=this;return e.isNumeric=function(t){return t="string"==typeof t?t.replace(",","."):t,!isNaN(parseFloat(t))&&isFinite(t)&&"[object array]"!==Object.prototype.toString.call(t).toLowerCase()},e.endsWith=function(t,e){return t.indexOf(e,t.length-e.length)!==-1},e.uid=function(){var t=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)});return e},e.isDateString=function(t){var e=Date.parse(t);return isNaN(t)&&!isNaN(e)},e.isNumeric=function(t){return t="string"==typeof t?t.replace(",","."):t,!isNaN(parseFloat(t))&&isFinite(t)&&"[object array]"!==Object.prototype.toString.call(t).toLowerCase()},e.isEmpty=function(t){for(var e in t)return!1;return!0},e.simpleComparison=function(t,e){return JSON.stringify(t)===JSON.stringify(e)},e.browserLocale=function(){return navigator.language?navigator.language:navigator.browserLanguage},e.addTrailingSlash=function(t){return e.endsWith(t,"/")?t:t+"/"},e.removeTrailingSlash=function(t){return e.endsWith(t,"/")?t.substr(0,t.length-1):t},e.extractFileExtension=function(t,e){var n=t.lastIndexOf("."),l=e?0:1;return n>-1?t.substr(n+l).toLowerCase():null},e.extractFilename=function(t){var e=t.lastIndexOf("/");return e>-1?t.substr(e+1):null},e.colorToHex=function(t,e){function n(t,e){var n=isNaN(e)?t:t+e;return n<0?n=0:n>255&&(n=255),n=Math.floor(n),n=n.toString(16),1===n.length?"0"+n:n}var l="";return t&&(l=n(t.red,e)+n(t.green,e)+n(t.blue,e)),l},e.getValidFileSuffix=function(t){var e=new Array;return 0==t.length||-1!=t.indexOf(".*")?e[0]="*":(t=" "+t+" ",t=t.replace(/\*/g," "),t=t.replace(/,/g," "),t=t.replace(/;/g," "),t=t.replace(/\./g," "),e=t.match(/\s\b\w*\b\s/g),e.forEach(function(t,e,n){n[e]=t.replace(/\s/g,"")})),e},e.showConfirmDialog=function(e){var n=t.open({templateUrl:"confirm_dialog.tpl.html",backdrop:"static",backdropClass:"active",size:"xs",resolve:{message:function(){return e}},controller:["$scope","message",function(t,e){t.message=e,t.cancel=function(){t.$dismiss()},t.submit=function(){t.$close()}}]});return n.result},e}]),tb.config(["$stateProvider",function(t){t.state("script_view",{url:"script_view",parent:"app",nav:!0,label:"Script",order:1,views:{app:{controller:"ScriptViewCtrl",templateUrl:"script_view.tpl.html"}}})}]),tb.controller("ScriptViewCtrl",["$scope","ScriptService","StylesService","Utils","ngToast","$timeout","clipboard",function(t,e,n,l,o,a,s){t.reset=function(){t.filename="",t.scriptContent="",t.pageContent="",t.pageNumbers=[],t.pageScript="",t.pageNotes="",t.rawBubbles="",t.bubbles=[],t.pageStyle="",t.panelSeparator=e.setting("panelSeparator"),t.useLayerGroups=e.setting("useLayerGroups"),t.mergeBubbles=e.setting("mergeBubbles"),t.styleSet=n.getStyleSet(),t.selectedStyleset=t.styleSet.id},t.browseScript=function(){var e=window.cep.fs.showOpenDialogEx(!1,!1,"Select script file","",l.getValidFileSuffix("*.txt"),void 0,!1);angular.isDefined(e.data[0])&&t.loadScript(e.data[0])},t.loadScript=function(n,a,s){var i=window.cep.fs.readFile(n);0===i.err?(e.setting("lastOpenedScript",n),t.filename=l.extractFilename(n),t.scriptContent=i.data,t.pageNumbers=e.getPageNumbers(t.scriptContent),t.pageNumbers.length>0?(s||(o.create({className:"info",content:t.pageNumbers.length+" page(s) found in file"}),t.selectedPage=t.pageNumbers[0]),null!=a&&(t.selectedPage=a)):(o.create({className:"info",content:"Did not find any page number in the script"}),e.setting("lastOpenedScript",null),e.setting("lastOpenedPage",null),t.reset())):(e.setting("lastOpenedScript",null),e.setting("lastOpenedPage",null),t.reset(),o.create({className:"danger",content:"Could not read the file"}))},t.setting=function(n,l){t[n]=e.setting(n,l)},t.loadPage=function(n){if(angular.isDefined(n)&&null!=n&&!l.isEmpty(t.scriptContent))if(t.pageScript=e.loadPage(t.scriptContent,n),null!=t.pageScript){var a=e.getTextStyles(t.pageScript[1],"default_style")[0];if(t.pageStyle=t.styleSet.styles.findIndex(function(t){return t.keyword==a})===-1?{keyword:a,inStyleSet:!1}:{keyword:a,inStyleSet:!0},t.$root.log("pageStyle",t.pageStyle),t.pageNotes=e.getNotes(t.pageScript[1]),t.$root.log("pageNotes",t.pageNotes),t.rawBubbles=t.pageScript[2],t.bubbles=[],t.$root.log("rawBubbles",t.rawBubbles),e.pageContainsText(t.rawBubbles)){t.$root.log("contains text");var s=[],i=t.pageStyle.keyword;s=t.rawBubbles.split("\n"),t.$root.log("lines",s),s.forEach(function(n){var o=e.getNotes(n),a=e.skipThisLine(n);if(a===!1||o){var s={text:e.cleanLine(n),styles:[],multibubblePart:!1,notes:o},r=[];if(s.text&&(e.isMultiBubblePart(n)?(r=e.getTextStyles(n,i),s.multibubblePart=!0):r=e.getTextStyles(n,t.pageStyle.keyword),i=r[0],s.styles=r.map(function(e){var n=t.styleSet.styles.findIndex(function(t){return t.keyword==e});return n===-1?{keyword:e,inStyleSet:!1}:{keyword:e,inStyleSet:!0}})),t.mergeBubbles&&1==s.multibubblePart){var c=t.bubbles[t.bubbles.length-1];c.merged=!0,c.siblings||(c.siblings=[]),c.siblings.push(s),c.styles=c.styles.concat(s.styles.filter(function(t){return!c.styles.find(function(e){return!!l.simpleComparison(e,t)})}))}else t.bubbles.push(s)}else null===a&&t.bubbles.push({panelSeparator:!0})})}e.setting("lastOpenedPage",n),t.$root.log("bubbles",t.bubbles)}else o.create({className:"info",content:"Could not find page "+n+" in file"}),t.selectedPage=null,e.setting("lastOpenedPage",null),t.bubbles=[];else t.bubbles=[]},t.incPageNumber=function(n){var l=n?1:-1;if(t.pageNumbers.length)if(angular.isDefined(t.selectedPage)){var o=t.pageNumbers.findIndex(function(e){return e==t.selectedPage});angular.isDefined(t.pageNumbers[o+l])&&(t.selectedPage=t.pageNumbers[o+l],e.setting("lastOpenedPage",t.selectedPage))}else t.selectedPage=t.pageNumbers[0]},t.typeset=function(n,l){if(t.selectedForcedStyle&&(t.$root.log("force style",t.selectedForcedStyle),l={keyword:t.selectedForcedStyle,inStyleSet:!0}),l.inStyleSet){var a=t.styleSet.styles.find(function(t){return t.keyword==l.keyword});a||(a=t.styleSet.styles[0]);var s=n.text;n.siblings&&n.siblings.forEach(function(t){s+="\r"+t.text});var i={text:s,style:a};e.maybeTypesetToPath(i).then(function(){},function(t){o.create({className:"danger",content:t})})}else o.create({className:"danger",content:'Style "'+l.keyword+'" not found in styleset'})},t.toClipboard=function(t){s.copyText(t)},t.reset(),t.loadStyleSet=function(){t.styleSet=n.getStyleSet(t.selectedStyleset)},a(function(){e.setting("lastOpenedScript")&&t.loadScript(e.setting("lastOpenedScript"),e.setting("lastOpenedPage"),!0)},300),t.$watch("selectedPage",function(e,n){angular.isDefined(e)&&t.loadPage(e)}),t.$watchGroup(["panelSeparator","mergeBubbles","textReplace"],function(e,n){angular.isDefined(e)&&t.loadPage(t.selectedPage)}),t.$watch("selectedStyleset",function(e,n){angular.isDefined(e)&&null!=e&&(t.loadStyleSet(e),t.loadPage(t.selectedPage))})}]),tb.factory("ScriptService",["$rootScope","$localStorage","$q","StylesService",function(t,e,n,l){var o=this;return o.init=function(){t.log("$localStorage",e),angular.isDefined(e.panelSeparator)||o.setting("panelSeparator","–"),angular.isDefined(e.useLayerGroups)||o.setting("useLayerGroups",!0),angular.isDefined(e.mergeBubbles)||o.setting("mergeBubbles",!1),angular.isDefined(e.lastOpenedScript)||o.setting("lastOpenedScript","")},o.setting=function(t,n){return angular.isDefined(n)&&(e[t]=n),e[t]},o.getPageNumbers=function(t){return tbHelper.getPageNumbers(t)},o.loadPage=function(e,n){var l=tbHelper.loadPage(e,n);return t.log("page Match",l),l},o.pageContainsText=function(t){return tbHelper.pageContainsText(t)},o.getTextStyles=function(t,e){return tbHelper.getTextStyles(t,e)},o.getNotes=function(t){return tbHelper.getNotes(t)},o.cleanLine=function(t){return tbHelper.cleanLine(t)},o.skipThisLine=function(t){return tbHelper.skipThisLine(t,o.setting("panelSeparator"))},o.isMultiBubblePart=function(t){return tbHelper.isMultiBubblePart(t)},o.maybeTypesetToPath=function(e){var l=n.defer(),a=angular.copy(e);return a.useLayerGroups=o.setting("useLayerGroups"),t.log("typesetObj",a),t.CSI.evalScript('tryExec("getSingleRectangleSelectionDimensions");',function(e){if(t.log("maybeTypesetToPath return",e),"no_document"==e)l.reject("No document");else{if("no_selection"==e)return o.typeset(a);if("multiple_paths"==e)l.reject("Too many paths. Only one path allowed.");else if("too_many_anchors"==e)l.reject("Too many anchors in path. Only rectangle paths are allowed (use the marquee tool).");else try{if(e=JSON.parse(e),angular.isDefined(e.p))return a.style.dimensions=e,o.typeset(a);l.reject("The dimensions were malformed.")}catch(t){l.reject("Could not parse the dimensions.")}}}),l.promise},o.typeset=function(e){var l=n.defer();return t.$root.CSI.evalScript('tryExec("typesetEX", '+JSON.stringify(e)+");",function(e){t.log("typeset return",e),"no_document"===e?l.reject("No document"):"done"===e?l.resolve():l.reject(e)}),l.promise},o.init(),o}]),tb.config(["$stateProvider",function(t){t.state("styles",{url:"styles",parent:"app",nav:!0,label:"Styles",order:0,views:{app:{controller:"StylesCtrl",templateUrl:"styles.tpl.html"}}})}]),tb.controller("StylesCtrl",["$scope","StylesService","ScriptService","ngToast","Utils","$uibModal",function(t,e,n,l,o,a){t.clearStyleFilter=function(){t.styleFilter=void 0},t.newStyleSet=function(){t.styleSet=tbHelper.getDummyStyleSet(),t.selectedStyleset=null},t.saveStyleSet=function(){try{e.saveStyleSet(t.styleSet),t.loadCurrentStyleSet(),l.create({className:"success",content:"Saved"})}catch(t){l.create({className:"danger",content:t})}},t.exportStyleSet=function(){if(angular.isDefined(t.selectedStyleset)){var n=e.getStyleSet(t.selectedStyleset);delete n.id;var a=window.cep.fs.showSaveDialogEx("Export styleset",void 0,o.getValidFileSuffix("*.json"),n.name+"_styleset.json",void 0,"Export style set",void 0);if(a.data){var s=window.cep.fs.writeFile(a.data,JSON.stringify(n,null,2));0!=s.err&&l.create({className:"danger",content:"Failed to write a file at the destination:"+a.data+", error code:"+s.err})}}},t.maybeAddStyleToSet=function(e){var n=t.styleSet.styles.findIndex(function(t){return t.keyword==e});n==-1&&t.styleSet.styles.push(tbHelper.getDummyStyle(e))},t.extendStyleSet=function(){var e=window.cep.fs.showOpenDialogEx(!1,!1,"Select script file","",o.getValidFileSuffix("*.txt"),void 0,!1);if(angular.isDefined(e.data[0])){var a=window.cep.fs.readFile(e.data[0]);if(0===a.err){var s=a.data,i=n.getPageNumbers(s),r=[];i.length>0?(i.forEach(function(t){var e=n.loadPage(s,t);if(null!=e){var l=[];if(l.push(n.getTextStyles(e[1],"default_style")[0]),n.pageContainsText(e[2])){var o=e[2].split("\n");o.forEach(function(t){var e=n.getTextStyles(t,"default_style");l=l.concat(e.filter(function(t){return l.indexOf(t)<0}))})}r=r.concat(l.filter(function(t){return r.indexOf(t)<0}))}}),r.forEach(function(e){t.maybeAddStyleToSet(e)}),l.create({className:"success",content:"Done"})):l.create({className:"info",content:"Did not find any page number in the script"})}else l.create({className:"danger",content:"Could not read the file"})}},t.importStyleSet=function(){var n=window.cep.fs.showOpenDialogEx(!1,!1,"Select styleset file","",o.getValidFileSuffix("*.json"),void 0,!1);if(angular.isDefined(n.data[0])){t.selectedStyleset=null;var a=window.cep.fs.readFile(n.data[0]);if(0===a.err)try{var s=JSON.parse(a.data);t.log("parsed",s),e.cleanAndCheckStyleSet(s),delete s.id,t.styleSet=angular.copy(s)}catch(e){t.styleSet=tbHelper.getDummyStyleSet(),l.create({className:"danger",content:"Import error: "+e})}else t.styleSet=tbHelper.getDummyStyleSet(),l.create({className:"danger",content:"Could not read the file"})}},t.exportStyleProps=function(){var t=window.cep.fs.showSaveDialogEx("Export fonts and style properties",void 0,o.getValidFileSuffix("*.json"),"tb_fonts_and_styleprops.json",void 0,"Export",void 0);t.data&&e.getAppFonts().then(function(e){var n={styleProperties:angular.copy(tbHelper.styleProps),fonts:e},o=window.cep.fs.writeFile(t.data,JSON.stringify(n,null,2));0!=o.err&&l.create({className:"danger",content:"Failed to write a file at the destination:"+t.data+", error code:"+o.err})})},t.addStyle=function(){t.styleSet.styles.push(tbHelper.getDummyStyle())},t.deleteStyleSet=function(){angular.isDefined(t.styleSet.id)&&o.showConfirmDialog('Are you sure you want to delete the style set "'+t.styleSet.name+'" ?').then(function(){e.deleteStyleSet(t.styleSet.id)===!0&&(l.create({className:"success",content:"Deleted"}),t.selectedStyleset=0)},function(){})},t.duplicateStyle=function(e){var n=angular.copy(e);n.keyword="Copy of "+n.keyword,delete n.default;var l=t.styleSet.styles.indexOf(e);l>-1?t.styleSet.styles.splice(l+1,0,n):t.styleSet.styles.push(n)},t.duplicateStyleSet=function(){if(angular.isDefined(t.selectedStyleset)){var n=e.getStyleSet(t.selectedStyleset);delete n.id,n.name="Copy of "+n.name,t.styleSet=n,t.selectedStyleset=null}},t.removeStyle=function(e){o.showConfirmDialog("Remove style ?").then(function(){var n=t.styleSet.styles.indexOf(e);n>-1&&t.styleSet.styles.splice(n,1)},function(){})},t.applyStyleSelectedLayers=function(t,n){var o=angular.copy(t);o.noResize=!n,e.actionSelectedLayers("applyStyle",o).then(function(){l.create({className:"success",content:"Done"})},function(t){l.create({className:"danger",content:t})})},t.setStyle=function(t){var n=angular.copy(t);e.setStyle(n).then(function(){},function(t){l.create({className:"danger",content:t})})},t.actionSelectedLayers=function(t,n){e.actionSelectedLayers(t,n).then(function(){l.create({className:"success",content:"Done"})},function(t){l.create({className:"danger",content:t})})},t.loadStyleSet=function(){t.styleSet=e.getStyleSet(t.selectedStyleset)},t.loadCurrentStyleSet=function(){t.styleSet=e.getStyleSet(),t.selectedStyleset=t.styleSet.id},t.loadCurrentStyleSet(),t.$watch("selectedStyleset",function(e,n){angular.isDefined(e)&&null!=e&&t.loadStyleSet(e)})}]),tb.directive("antialiasSelector",["StylesService",function(t){return{restrict:"E",scope:{selectedValue:"="},replace:!0,template:'<select ng-options="choice.value as choice.label for choice in choices" ng-model="selectedValue"></select>',link:function(t,e,n){t.choices=tbHelper.styleProps.antialias.values,t.selectedValue||(t.selectedValue=tbHelper.styleProps.antialias.def)}}}]),tb.directive("capitalizationSelector",["StylesService",function(t){return{restrict:"E",scope:{selectedValue:"="},replace:!0,template:'<select ng-options="choice.value as choice.label for choice in choices" ng-model="selectedValue"></select>',link:function(t,e,n){t.choices=tbHelper.styleProps.capitalization.values,t.selectedValue||(t.selectedValue=tbHelper.styleProps.capitalization.def)}}}]),tb.directive("fontSelector",["StylesService",function(t){return{restrict:"E",scope:{selectedValue:"="},replace:!0,template:'<select ng-options="choice.value as choice.label for choice in choices | orderBy: \'label\'" ng-model="selectedValue"></select>',link:function(e,n,l){t.getAppFonts().then(function(t){e.choices=t,e.selectedValue||(e.selectedValue=tbHelper.styleProps.fontName.def)})}}}]),tb.directive("justificationSelector",["StylesService",function(t){return{restrict:"E",scope:{selectedValue:"="},replace:!0,template:'<select ng-options="choice.value as choice.label for choice in choices" ng-model="selectedValue"></select>',link:function(t,e,n){t.choices=tbHelper.styleProps.justification.values,t.selectedValue||(t.selectedValue=tbHelper.styleProps.justification.def)}}}]),tb.directive("kerningSelector",["StylesService",function(t){return{restrict:"E",scope:{selectedValue:"="},replace:!0,template:'<select ng-options="choice.value as choice.label for choice in choices" ng-model="selectedValue"></select>',link:function(t,e,n){t.choices=tbHelper.styleProps.kerning.values,t.selectedValue||(t.selectedValue=tbHelper.styleProps.kerning.def)}}}]),tb.directive("tbStylePreset",[function(){return{restrict:"E",scope:{preset:"=",removeAction:"&",duplicateAction:"&",applyAction:"&",setAction:"&"},templateUrl:"style_preset.tpl.html",controller:["$scope","StylesService",function(t,e){}]}}]),tb.directive("tbStyleSelector",["StylesService",function(t){return{restrict:"E",scope:{styleset:"=",selectedValue:"="},replace:!0,template:'<select ng-options="choice as choice for choice in choices" ng-model="selectedValue"><option value="">-</option></select>',link:function(e,n,l){e.refreshStyleList=function(){e.choices=[];var n=t.getStyleSet(e.styleset);n.styles.forEach(function(t){e.choices.push(t.keyword)}),e.selectedValue||(e.selectedValue=null)},e.$watch("styleset",function(t,n){angular.isDefined(t)?e.refreshStyleList():e.choices=[]})}}}]),tb.directive("stylesetSelector",["StylesService",function(t){return{restrict:"E",scope:{selectedValue:"="},replace:!0,template:'<select ng-options="choice.id as choice.name for choice in choices" ng-model="selectedValue"></select>',link:function(e,n,l){e.choices=[],e.refreshStylesetList=function(){e.choices=t.getStyleSetList(),e.selectedValue||(e.selectedValue=e.choices[0].id)},e.$on("refresh-styleset-list",e.refreshStylesetList),e.refreshStylesetList()}}}]),tb.factory("StylesService",["$rootScope","$localStorage","$q","Utils","ngToast",function(t,e,n,l,o){var a=this;if(a.appFonts=[],a.getAppFonts=function(){var e=n.defer();return a.appFonts.length?e.resolve(angular.copy(a.appFonts)):t.CSI.evalScript("getAppFonts();",function(t){a.appFonts=JSON.parse(t),e.resolve(angular.copy(a.appFonts))}),e.promise},a.getStyleSetList=function(){return e.styleSets},a.cleanAndCheckStyleSet=function(t){if(!angular.isDefined(t.name)||!t.name||!t.name.trim())throw"Need a name";if(t.name.length>25)throw"Name must be less than 25 characters";tbHelper.checkStyleSet(t);var n=e.styleSets.findIndex(function(e){return e.id==t.id}),l=-1;n>-1&&(l=e.styleSets[n].id);for(var o=0;o<e.styleSets.length;o++)if(e.styleSets[o].name.trim().toLowerCase()==t.name.trim().toLowerCase()&&e.styleSets[o].id!=l)throw"A styleset with the same name already exists";for(var a=0;a<t.styles.length;a++)if(angular.isDefined(t.styles[a+1])&&t.styles[a].keyword==t.styles[a+1].keyword)throw"The styleset contains duplicate style keywords"},a.saveStyleSet=function(n){a.cleanAndCheckStyleSet(n);var l=e.styleSets.findIndex(function(t){return t.id==n.id});if(l>-1)e.styleSets[l]=angular.copy(n);else{var o=-1;e.styleSets.forEach(function(t){t.id>o&&(o=t.id)}),n.id=++o,e.styleSets.push(angular.copy(n))}e.lastOpenedStyleSet=n.id,t.$broadcast("refresh-styleset-list")},a.getStyleSet=function(t){var n=void 0;if(angular.isDefined(t)){var l=e.styleSets.findIndex(function(e){return e.id==t});l>-1&&(n=angular.copy(e.styleSets[l]))}else angular.isDefined(e.lastOpenedStyleSet)&&(n=a.getStyleSet(e.lastOpenedStyleSet));return n?(e.lastOpenedStyleSet=n.id,n):tbHelper.getDummyStyleSet()},a.deleteStyleSet=function(n){var l=e.styleSets.findIndex(function(t){return t.id==n});return 0===e.styleSets[l].id?(o.create({className:"danger",content:"Cannot delete default style set"}),!1):l>-1?(e.styleSets.splice(l,1),delete e.lastOpenedStyleSet,t.$broadcast("refresh-styleset-list"),!0):void 0},a.setStyle=function(e){var l=n.defer();return t.$root.CSI.evalScript('tryExec("setStyle", '+JSON.stringify(e)+");",function(e){t.log("setStyle return",e),"no_document"===e?l.reject("No document."):"done"===e?l.resolve():l.reject(e)}),l.promise},a.actionSelectedLayers=function(e,l){var o=n.defer(),a='"'+e+'SelectedLayers"';return angular.isDefined(l)&&(a+=", "+JSON.stringify(l)),t.$root.CSI.evalScript("tryExec("+a+");",function(e){t.log(a+" return",e),"no_document"===e?o.reject("No document."):"no_selected_layers"===e?o.reject("Could not retrieve the selected layers."):"not_text_layer"===e?o.reject("Not a text layer."):"done"===e?o.resolve():o.reject(e)}),o.promise},!e.styleSets){e.styleSets=[];var s=tbHelper.getDummyStyleSet();s.name="Default set",a.saveStyleSet(s)}return a}]),angular.module("templates",[]).run(["$templateCache",function(t){t.put("app.tpl.html",'<uib-tabset active="null" class="">\n\t<uib-tab index="one.name" heading="{{one.label}}" ui-sref="{{one.name}}" ui-sref-active="active" ng-repeat="one in routes"></uib-tab>\n\t<uib-tab index="9" heading="Log" ui-sref="log_view" ui-sref-active="active" ng-if="$root.debug"></uib-tab>\n\t<uib-tab index="10" heading="RESET" ng-click="resetLocalStorage()" ng-if="$root.debug"></uib-tab>\n\n\n</uib-tabset>\n\n<ui-view name="app" class="flex-col"></ui-view>'),t.put("confirm_dialog.tpl.html",'<div class="modal-header">\n\t<h3 class="modal-title" id="modal-title">Confirm</h3>\n</div>\n<div class="modal-body" id="modal-body">\n\t{{message}}\n</div>\n<div class="modal-footer">\n\t<button class="btn btn-primary" type="button" ng-click="submit()">OK</button>\n\t<button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button>\n</div>'),t.put("log_view.tpl.html",'<div class="no-shrink p header">\n\t<button class="topcoat-button" ng-click="clearLog()">\n\t\t<span class="glyphicon glyphicon-trash"></span>\n\t\tClear log\n\t</button>\n</div>\n<div class="list scrollable">\n\t<div class="no-shrink row pb" ng-repeat="entry in $root.logContent">\n\t\t<div class="col-md-2 col-xs-2">\n\t\t\t<label>{{entry.label}}</label>\n\t\t</div>\n\t\t<div class="col-md-10 col-xs-10">\n\t\t\t<pre>{{entry.value|json}}</pre>\n\t\t</div>\n\t</div>\n</div>\n'),t.put("script_view.tpl.html",'<div class="row no-shrink">\n\t<div class="col-md-6 col-xs-6 flex-input">\n\t\t<div class="input-wrapper">\n\t\t\t<label class="">\n\t\t\t\t<span>Script</span>\n\t\t\t</label>\n\t\t\t<input type="text" class="topcoat-text-input" readonly="true" ng-model="filename" ng-click="browseScript()">\n\t\t</div>\n\t\t<!-- <button class="topcoat-button" ng-click="browseScript()">Browse...</button> -->\n\t</div>\n\t<div class="col-md-5 col-xs-5 flex-input">\n\t\t<div class="input-wrapper">\n\t\t\t<label class="">\n\t\t\t\t<span>Style Set</span>\n\t\t\t</label>\n\t\t\t<styleset-selector selected-value="selectedStyleset"></styleset-selector>\n\t\t</div>\n\t</div>\n\n\t<div class="col-md-1 col-xs-1 flex-input">\n\t\t<div class="btn-group" uib-dropdown is-open="status.isopen">\n\t\t\t<button class="topcoat-button" uib-dropdown-toggle>\n\t\t\t\t<span class="glyphicon glyphicon-cog"></span>\n\t\t\t</button>\n\t\t\t<ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu role="menu" aria-labelledby="single-button">\n\t\t\t\t<li class="dropdown-header">Panel separator</li>\n\t\t\t\t<li role="menu-item" ng-class="{\'active\': panelSeparator == \'–\'}" ng-click="setting(\'panelSeparator\', \'–\')"><span>Long dash –</span></li>\n\t\t\t\t<li role="menu-item" ng-class="{\'active\': panelSeparator == \'-\'}" ng-click="setting(\'panelSeparator\', \'-\')"><span>Single dash -</span></li>\n\t\t\t\t<li role="menu-item" ng-class="{\'active\': panelSeparator == \'--\'}" ng-click="setting(\'panelSeparator\', \'--\')"><span>Double dash --</span></li>\n\t\t\t\t<li role="menu-item" ng-class="{\'active\': panelSeparator == \'=\'}" ng-click="setting(\'panelSeparator\', \'=\')"><span>Equal sign =</span></li>\n\t\t\t\t<li class="divider"></li>\n\t\t\t\t<li role="menu-item" class="dropdown-header">Use layer groups</li>\n\t\t\t\t<li role="menu-item" ng-class="{\'active\': useLayerGroups === true}" ng-click="setting(\'useLayerGroups\', true)"><span>Yes</span></li>\n\t\t\t\t<li role="menu-item" ng-class="{\'active\': useLayerGroups === false}" ng-click="setting(\'useLayerGroups\', false)" ><span>No</span></li>\n\t\t\t\t<li class="divider"></li>\n\t\t\t\t<li role="menu-item" class="dropdown-header">Merge multibubbles</li>\n\t\t\t\t<li role="menu-item" ng-class="{\'active\': mergeBubbles === true}" ng-click="setting(\'mergeBubbles\', true)"><span>Yes</span></li>\n\t\t\t\t<li role="menu-item" ng-class="{\'active\': mergeBubbles === false}" ng-click="setting(\'mergeBubbles\', false)" ><span>No</span></li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</div>\n<div class="no-shrink row pb header">\n\t<div class="col-lg-4 col-md-4 col-xs-4">\n\t\t<label>Page</label>\n\t\t<button class="topcoat-icon-button--quiet" ng-disabled="!!!pageNumbers.length">\n\t\t\t<span class="glyphicon glyphicon-minus" ng-click="incPageNumber(false)"></span>\n\t\t</button>\n\n\t\t\t<select ng-options="pageNumber as pageNumber for pageNumber in pageNumbers" ng-model="selectedPage">\n\t\t\t\t<option value="">-</option>\n\t\t\t</select>\n\n\t\t<button class="topcoat-icon-button--quiet" ng-disabled="!!!pageNumbers.length">\n\t\t\t<span class="glyphicon glyphicon-plus" ng-click="incPageNumber(true)"></span>\n\t\t</button>\n\t</div>\n\t<div class="col-lg-4 col-md-4 col-xs-4">\n\t\t<label ng-if="!!selectedPage && !!bubbles.length">\n\t\t\tPage style: {{pageStyle.keyword}} <span class="glyphicon glyphicon-warning-sign" ng-if="!!!pageStyle.inStyleSet"></span>\n\t\t</label>\n\t</div>\n\t<div class="col-lg-4 col-md-4 col-xs-4">\n\t\t<label>\n\t\t\tForce\n\t\t</label>\n\t\t<tb-style-selector styleset="selectedStyleset" selected-value="selectedForcedStyle"></tb-style-selector>\n\t</div>\n\n</div>\n<div class="page-note" ng-repeat="pageNote in pageNotes">\n\t{{pageNote}}\n</div>\n<div class="list scrollable">\n\t<div class="list-item p" ng-if="!!selectedPage && !!!bubbles.length">Nothing to typeset on this page</div>\n\t<div class="list-item row bubble-item" ng-class="{\'multibubble-part\': !!bubble.multibubblePart, \'panel-separator\': !!bubble.panelSeparator}" ng-repeat="bubble in bubbles">\n\t\t<div class="col-lg-2 col-md-3 col-xs-3 style-buttons" ng-if="!!!bubble.panelSeparator">\n\t\t\t<button class="topcoat-button" ng-repeat="style in bubble.styles track by $index" ng-click="typeset(bubble, style)" uib-tooltip="Create it first or use the force :D" tooltip-popup-delay="1000" tooltip-placement="bottom-left" tooltip-enable="!!!style.inStyleSet">\n\t\t\t\t<span>{{style.keyword}}</span>\n\t\t\t\t<span class="glyphicon glyphicon-warning-sign" ng-if="!!!style.inStyleSet"></span>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="col-lg-10 col-md-9 col-xs-9" ng-if="!!!bubble.panelSeparator">\n\t\t\t<div class="selectable bubble-content" ng-if="!!bubble.text">{{bubble.text}}<button class="topcoat-button clipbutton">\n\t\t\t\t\t<span class="glyphicon glyphicon-copy" ng-click="toClipboard(bubble.text)"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="bubble-note selectable" ng-repeat="note in bubble.notes">\n\t\t\t\t{{note}}\n\t\t\t\t<button class="topcoat-button clipbutton">\n\t\t\t\t\t<span class="glyphicon glyphicon-copy" ng-click="toClipboard(bubble.notes)"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="bubble-sibling" ng-repeat="sibling in bubble.siblings">\n\t\t\t\t<div class="selectable bubble-content">{{sibling.text}}<button class="topcoat-button clipbutton">\n\t\t\t\t\t\t<span class="glyphicon glyphicon-copy" ng-click="toClipboard(sibling.text)"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="bubble-note selectable" ng-repeat="note in sibling.notes">\n\t\t\t\t\t{{note}}\n\t\t\t\t\t<button class="topcoat-button clipbutton">\n\t\t\t\t\t\t<span class="glyphicon glyphicon-copy" ng-click="toClipboard(note)"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n</div>'),
t.put("style_preset.tpl.html",'<div class="row m0">\n\t<div class="col-md-4 col-xs-4">\n\t\t<label class="input-flex">\n\t\t\t<span>Keyword</span>\n\t\t\t<input type="text" class="topcoat-text-input" placeholder="Keyword" ng-model="preset.keyword" ng-disabled="preset.default" ng-pattern="/^[\\d\\w_]+$/i">\n\t\t</label>\n\t</div>\n\t<div class="col-md-6 col-xs-6">\n\t\t<label class="input-flex input-flex-larger">\n\t\t\t<span>Font</span>\n\t\t\t<font-selector selected-value="preset.fontName"></font-selector>\n\t\t</label>\n\t</div>\n\t<div class="col-md-2 col-xs-2 text-right">\n\t\t<button class="topcoat-button" ng-click="duplicateAction()" uib-tooltip="Duplicate style" tooltip-popup-delay="500" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-duplicate"></span>\n\t\t</button>\n\t\t<button class="topcoat-button" ng-click="removeAction()" ng-if="!!!preset.default" uib-tooltip="Remove style" tooltip-popup-delay="500" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-trash"></span>\n\t\t</button>\n\t</div>\n</div>\n\n<div class="row m0">\n\t<div class="col-md-4 col-xs-4">\n\t\t<div>\n\t\t\t<label class="input-flex">\n\t\t\t\t<span>Size (px)</span>\n\t\t\t\t<input type="number" class="topcoat-text-input" min="1" max="1000" step="1" ng-model="preset.size" placeholder="1 to 1000 px" uib-tooltip="min:1 max:1000 default:20" tooltip-popup-delay="500" tooltip-placement="bottom-right">\n\t\t\t</label>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class="input-flex">\n\t\t\t\t<span>VScale (%)</span>\n\t\t\t\t<input type="number" class="topcoat-text-input" min="1" max="1000" step="1" ng-model="preset.vScale" placeholder="1 to 1000 %" uib-tooltip="min:1 max:1000 default:100" tooltip-popup-delay="500" tooltip-placement="bottom-right">\n\t\t\t</label>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class="input-flex">\n\t\t\t\t<span>HScale (%)</span>\n\t\t\t\t<input type="number" class="topcoat-text-input" min="1" max="1000" step="1" ng-model="preset.hScale" placeholder="1 to 1000 %" uib-tooltip="min:1 max:1000 default:100" tooltip-popup-delay="500" tooltip-placement="bottom-right">\n\t\t\t</label>\n\t\t</div>\n\t\t<div class="input-flex">\n\t\t\t<label>\n\t\t\t\t<span>Hyphenate</span>\n\t\t\t</label>\n\t\t\t<div>\n\t\t\t\t<label class="topcoat-switch">\n\t\t\t\t\t<input type="checkbox" ng-model="preset.hyphenate" ng-true-value="true" class="topcoat-switch__input">\n\t\t\t\t\t<div class="topcoat-switch__toggle"></div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="col-md-4 col-xs-4">\n\t\t<div>\n\t\t\t<label class="input-flex">\n\t\t\t\t<span>Leading (px)</span>\n\t\t\t\t<input type="number" class="topcoat-text-input" min="0" max="1000" step="1" ng-model="preset.leading" placeholder="0 to 1000" uib-tooltip="min:0 max:1000 default:0 (auto)" tooltip-popup-delay="500" tooltip-placement="bottom-right">\n\t\t\t</label>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class="input-flex">\n\t\t\t\t<span>Tracking</span>\n\t\t\t\t<input type="number" class="topcoat-text-input" min="-1000" max="10000" step="1" ng-model="preset.tracking" placeholder="-1000 to 10000" uib-tooltip="min:-1000 max:10000 default:0" tooltip-popup-delay="500" tooltip-placement="bottom-right">\n\t\t\t</label>\n\t\t</div>\n\t\t<div class="input-flex">\n\t\t\t<label>\n\t\t\t\t<span>FauxBold</span>\n\t\t\t</label>\n\t\t\t<div>\n\t\t\t\t<label class="topcoat-switch">\n\t\t\t\t\t<input type="checkbox" ng-model="preset.fauxBold" ng-true-value="true" class="topcoat-switch__input">\n\t\t\t\t\t<div class="topcoat-switch__toggle"></div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="input-flex">\n\t\t\t<label>\n\t\t\t\t<span>FauxItalic</span>\n\t\t\t</label>\n\t\t\t<div>\n\t\t\t\t<label class="topcoat-switch">\n\t\t\t\t\t<input type="checkbox" ng-model="preset.fauxItalic" ng-true-value="true" class="topcoat-switch__input">\n\t\t\t\t\t<div class="topcoat-switch__toggle"></div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="col-md-4 col-xs-4">\n\t\t<div>\n\t\t\t<label class="input-flex">\n\t\t\t\t<span>Antialias</span>\n\t\t\t\t<antialias-selector selected-value="preset.antialias"></antialias-selector>\n\t\t\t</label>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class="input-flex">\n\t\t\t\t<span>Capitalization</span>\n\t\t\t\t<capitalization-selector selected-value="preset.capitalization"></capitalization-selector>\n\t\t\t</label>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class="input-flex">\n\t\t\t\t<span>Justification</span>\n\t\t\t\t<justification-selector selected-value="preset.justification"></justification-selector>\n\t\t\t</label>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class="input-flex">\n\t\t\t\t<span>Kerning</span>\n\t\t\t\t<kerning-selector selected-value="preset.kerning"></kerning-selector>\n\t\t\t</label>\n\t\t</div>\n\t</div>\n</div>\n<div class="row m0">\n\t<div class="col-md-4 col-xs-4">\n\t\t<label class="input-flex">\n\t\t\t<span>Layer group</span>\n\t\t\t<input type="text" class="topcoat-text-input" placeholder="Layer group" ng-model="preset.layerGroup" >\n\t\t</label>\n\t</div>\n\t<div class="col-md-8 col-xs-8 text-right">\n\t\t<button class="topcoat-button" ng-click="setAction()" uib-tooltip="Just set the style parameters" tooltip-popup-delay="500" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-text-color"></span>\n\t\t</button>\n\t\t<button class="topcoat-button" ng-click="applyAction()" uib-tooltip="Apply style on selected text layers" tooltip-popup-delay="500" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-tint"></span>\n\t\t</button>\n\t\t<button class="topcoat-button" ng-click="applyAction({style:preset, resize:true})" uib-tooltip="Apply style on selected text layers and auto-resize them" tooltip-popup-delay="500" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-tint"></span>+<span class="glyphicon glyphicon-resize-small"></span>\n\t\t</button>\n\t</div>\n</div>'),t.put("styles.tpl.html",'<div class="no-shrink p">\n\t<button class="topcoat-button" ng-click="newStyleSet()" uib-tooltip="Create a new set" tooltip-popup-delay="1000" tooltip-placement="bottom-left">\n\t<span class="glyphicon glyphicon-plus"></span>\n\t\t<!-- New -->\n\t</button>\n\t<button class="topcoat-button" ng-click="importStyleSet()" uib-tooltip="Import a set from a json file" tooltip-popup-delay="1000" tooltip-placement="bottom-left">\n\t\t<span class="glyphicon glyphicon-import"></span>\n\t\t<!-- Import -->\n\t</button>\n\t<button class="topcoat-button" ng-click="extendStyleSet()" uib-tooltip="Analyze a translation script and extend the current set with keywords found within it" tooltip-popup-delay="1000" tooltip-placement="bottom-left">\n\t\t<span class="glyphicon glyphicon-indent-right"></span>\n\t\t<!-- Extend -->\n\t</button>\n\t<button class="topcoat-button" ng-click="saveStyleSet()" uib-tooltip="Save current set" tooltip-popup-delay="1000" tooltip-placement="bottom">\n\t\t<span class="glyphicon glyphicon-floppy-disk"></span>\n\t\t<!-- Save -->\n\t</button>\n\t<button class="topcoat-button" ng-click="exportStyleSet()" ng-disabled="selectedStyleset == undefined" uib-tooltip="Export current set as a json file" tooltip-popup-delay="1000" tooltip-placement="bottom">\n\t\t<span class="glyphicon glyphicon-export"></span>\n\t\t<!-- Export -->\n\t</button>\n\t<button class="topcoat-button" ng-click="duplicateStyleSet()" ng-disabled="selectedStyleset == undefined" uib-tooltip="Duplicate current set\n\t" tooltip-popup-delay="1000" tooltip-placement="bottom">\n\t\t<span class="glyphicon glyphicon-duplicate"></span>\n\t\t<!-- Duplicate -->\n\t</button>\n\t<button class="topcoat-button" ng-click="deleteStyleSet()" ng-disabled="!!!selectedStyleset" uib-tooltip="Delete current set\n\t" tooltip-popup-delay="1000" tooltip-placement="bottom">\n\t\t<span class="glyphicon glyphicon-trash"></span>\n\t\t<!-- Delete -->\n\t</button>\n\t<styleset-selector selected-value="selectedStyleset"></styleset-selector>\n\n\t<div class="pull-right">\n\t\t<button class="topcoat-button" ng-click="actionSelectedLayers(\'toggleHyphenation\')" uib-tooltip="Toggle hyphenation on selected layers" tooltip-popup-delay="1000" tooltip-placement="bottom-right">\n\t\t\t<strong>H</strong><span class="glyphicon glyphicon-minus"></span>\n\t\t</button>\n\t\t<button class="topcoat-button" ng-click="actionSelectedLayers(\'toggleFauxBold\')" uib-tooltip="Toggle faux bold on selected layers" tooltip-popup-delay="1000" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-bold"></span>\n\t\t</button>\n\t\t<button class="topcoat-button" ng-click="actionSelectedLayers(\'toggleFauxItalic\')" uib-tooltip="Toggle faux italic on selected layers" tooltip-popup-delay="1000" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-italic"></span>\n\t\t</button>\n\t\t<button class="topcoat-button" ng-click="actionSelectedLayers(\'adjustFontSize\', -1)" uib-tooltip="Decrease font size by 1 pixel on selected layers" tooltip-popup-delay="1000" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-text-height"></span>-\n\t\t</button>\n\t\t<button class="topcoat-button" ng-click="actionSelectedLayers(\'adjustFontSize\', 1)" uib-tooltip="Increase font size by 1 pixel on selected layers" tooltip-popup-delay="1000" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-text-height"></span>+\n\t\t</button>\n\t\t<button class="topcoat-button" ng-click="actionSelectedLayers(\'roundFontSize\')" uib-tooltip="Round font size on selected layers" tooltip-popup-delay="1000" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-text-height"></span>o\n\t\t</button>\n\t\t<button class="topcoat-button" ng-click="actionSelectedLayers(\'autoResize\')" uib-tooltip="Auto resize selected layers" tooltip-popup-delay="500" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-resize-small"></span>\n\t\t</button>\n\t</div>\n</div>\n\n<div class="row no-shrink pb header">\n\t<div class="col-md-4 col-xs-4">\n\t\t<label>\n\t\t\tName\n\t\t\t<input type="text" class="topcoat-text-input" placeholder="Styleset name" ng-model="styleSet.name" ng-disabled="selectedStyleset === 0" ng-pattern="/[\\d\\w]{1,30}/">\n\t\t</label>\n\t</div>\n\t<div class="col-md-5 col-xs-5">\n\t\t<label>\n\t\t\tStyle filter\n\t\t\t<input type="text" class="topcoat-text-input" placeholder="filter..." ng-model="styleFilter">\n\t\t</label>\n\t\t<button class="topcoat-button" ng-click="clearStyleFilter()" ng-if="!!styleFilter">\n\t\t\t<span class="glyphicon glyphicon-remove"></span>\n\t\t</button>\n\t</div>\n\t<div class="col-md-3 col-xs-3 text-right">\n\t\t<button class="topcoat-button" ng-click="addStyle()">Add Style</button>\n\t</div>\n</div>\n<div class="list scrollable padded">\n\t<div class="list-item" ng-repeat="style in styleSet.styles |filter: {keyword: styleFilter||undefined}">\n\t\t<tb-style-preset preset="style" remove-action="removeStyle(style)" duplicate-action="duplicateStyle(style)" apply-action="applyStyleSelectedLayers(style, resize)" set-action="setStyle(style)" ng-class="{\'default-style\': style.default}"></tb-style-preset>\n\t</div>\n</div>\n<div class="row no-shrink pv">\n\t<div class="col-md-4 col-xs-4">\n\t\t<button class="topcoat-button" ng-click="exportStyleProps()" uib-tooltip="Export available fonts and style properties" tooltip-popup-delay="1000" tooltip-placement="bottom-right">\n\t\t\t<span class="glyphicon glyphicon-book"></span>\n\t\t</button>\n\t</div>\n\t<div class="col-md-5 col-xs-5">\n\n\t</div>\n\t<div class="col-md-3 col-xs-3 text-right">\n\t\t<button class="topcoat-button" ng-click="addStyle()">Add Style</button>\n\t</div>\n</div>')}]);